<div class="panorama">
  <div [ngClass]="{'panoModeClass': panoMode}" class="image-owner" id="image-owner">
    <div id="pano-image" class="image">
      <img [src]="panoramaUrl" *ngIf="panoramaUrl" (click)="panoTouched()"/>

      <ng-container *ngFor="let displayType of currentlyDisplayed">
        <ng-container *ngFor="let annotation of annotations(displayType)">
          <div class="{{displayType}}Annotation annotation"
          [class.selected]="(this.currentId === annotation.labelId) && !this.panoMode"
          [ngStyle]="setLabelStyles(displayType,annotation)"
          (click)="annotationClicked(annotation)"></div>
          <ng-container *ngIf="qaModesTurnedOn.includes('debug') && currentlyDisplayed.includes('shelfLabels')">
            <ng-container *ngFor="let productCoordinate of annotation.productCoordinates">
              <div class="productAnnotation annotation"
              [class.selected]="(this.currentId === annotation.labelId) && !this.panoMode"
              [style.left.px]="productCoordinate.left"
              [style.top.px]="productCoordinate.top"
              [style.width.px]="productCoordinate.width"
              [style.height.px]="productCoordinate.height"
              (click)="annotationClicked(annotation)"></div>
            </ng-container>
          </ng-container>
        </ng-container>
      </ng-container>

      <ul id="annotationSelector" *ngIf="annotationMenu !== 'none'"
        [style.left.px]="annotationLeft"
        [style.top.px]="annotationTop">
        <ng-container *ngFor="let category of categories(); let i = index">
          <li
            [ngStyle]="setAnnotationStyles(category.category, hovered, i, category.color)" (mouseover)="hovered = i" (mouseleave)="hovered = -1" 
            (click)="setCategory(category.category)">
            {{category.category}} <span>{{category.hotkey | uppercase}}</span>
          </li>
        </ng-container>
        <li *ngIf="(annotationMenu === 'missed' && selectedMarkerCategory) || (annotationMenu === 'misread' && selectedAnnotation.misreadType)" 
          class="delete" (click)="deleteCategory()">Delete</li>
      </ul>

      <ng-container *ngIf="qaModesTurnedOn.includes('missingBarcodes')">
        <ng-container *ngFor="let marker of missedBarcodeMarkers; let i = index">
          <div class="marker" [ngStyle]="setMarkerStyles(marker.top, marker.left, marker.category)" (click)="editMarker(i)"></div>
        </ng-container>
      </ng-container>

      <ng-container *ngIf="qaModesTurnedOn.includes('debug') && currentlyDisplayed.includes('shelfLabels')">
        <svg>
          <ng-container *ngFor="let annotation of labels">
            <ng-container *ngFor="let productCoordinate of annotation.productCoordinates">
              <line 
              [attr.x1]="annotation.bounds.left+annotation.bounds.width/2+10" 
              [attr.y1]="annotation.bounds.top" 
              [attr.x2]="productCoordinate.left+productCoordinate.width/2+10" 
              [attr.y2]="productCoordinate.top+productCoordinate.height/2+10" />
            </ng-container>
          </ng-container>
        </svg>
      </ng-container>
      
      <ng-container *ngIf="currentlyDisplayed.includes('sectionBreaks')">
        <ng-container *ngFor="let sectionBreak of sectionBreaks">
          <div class="break" [style.left.px]="sectionBreak"></div>
        </ng-container>
      </ng-container>

    </div>
  </div>
  <div id="zoom">
    <fa-icon id="zoomIn" class="zoomIcon" [icon]="faPlus" (click)="zoomIn()"></fa-icon>
    <fa-icon id="zoomOut" class="zoomIcon" [icon]="faMinus" (click)="zoomOut()"></fa-icon>
  </div>
</div>
